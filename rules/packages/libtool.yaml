package: libtool
smoke_test:
- command: /usr/sgug/bin/libtool --version
  expect: 2.4.7
rules:
  export_vars:
    PERL: /usr/bin/perl
    AUTOCONF: /usr/bin/autoconf
    AUTOM4TE: /usr/bin/autom4te
    ACLOCAL: /usr/bin/aclocal
    AUTOMAKE: /usr/bin/automake
    AUTOHEADER: /usr/bin/autoheader
  prep_commands:
  - find . -name aclocal.m4 -o -name configure -o -name Makefile.in -o -name config.h.in | xargs touch
  drop_requires:
  - gcc(major)
  - automake = 1.16.5
  install_cleanup:
  - sed -i 's|#!.*/bin/bash|#!/bin/ksh|g' %{buildroot}%{_bindir}/libtool %{buildroot}%{_bindir}/libtoolize
  spec_replacements:
  - pattern: "%make_build \\\n    CUSTOM_LTDL_CFLAGS=\"%_hardening_cflags\" \\\n    CUSTOM_LTDL_LDFLAGS=\"%_hardening_ldflags\"\n"
    replacement: '%make_build HELP2MAN=true'
  - pattern: '%make_install'
    replacement: '%make_install HELP2MAN=true'
  - pattern: '%{_infodir}/libtool.info*.gz'
    replacement: '%{_infodir}/libtool.info*'
  - pattern: '%configure'
    replacement: '%configure --host=mips-sgi-irix6.5'
  - pattern: rm -f %{buildroot}%{_libdir}/libltdl.{a,la}
    replacement: rm -f %{buildroot}%{_libdir}/libltdl.a %{buildroot}%{_libdir}/libltdl.la
