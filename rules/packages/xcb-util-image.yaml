# xcb-util-image 0.4.1 - XCB image convenience functions (FC40: 0.4.1-5)
package: xcb-util-image

rules:

  prep_commands:
    # Fix clang error: non-void function doesn't return in all paths
    # assert(0) is a no-op with NDEBUG, so add explicit return
    - "sed -i 's/assert(0);$/assert(0); return XCB_IMAGE_ORDER_MSB_FIRST;/' image/xcb_bitops.h"

  spec_replacements:
    - pattern: "Requires:       %{name}%{?_isa}"
      replacement: "Requires:       %{name}"
    - pattern: "%ldconfig_post"
      replacement: "# ldconfig_post removed"
    - pattern: "%ldconfig_postun"
      replacement: "# ldconfig_postun removed"
    - pattern: "URL:            http://xcb.freedesktop.org/"
      replacement: |
        URL:            http://xcb.freedesktop.org/
        Provides: libxcb-image.so.0(mips-32)
    - pattern: "rm %{buildroot}%{_libdir}/*.la"
      replacement: "rm -f %{buildroot}%{_libdir}/*.la || true"


