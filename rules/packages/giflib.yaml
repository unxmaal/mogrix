package: giflib
rules:
  drop_subpackages:
  - mingw32-*
  - mingw64-*
  drop_buildrequires:
  - xmlto
  - mingw32-filesystem
  - mingw32-gcc
  - mingw64-filesystem
  - mingw64-gcc
  spec_replacements:
  - pattern: '%cmake

      %cmake_build'
    replacement: "mkdir -p _build && cd _build\ncmake .. \\\n  -DCMAKE_INSTALL_PREFIX=%{_prefix} \\\n  -DCMAKE_INSTALL_LIBDIR=lib32 \\\n  -DCMAKE_C_COMPILER=%{__cc} \\\n  -DCMAKE_AR=%{__ar} \\\n  -DCMAKE_RANLIB=%{__ranlib}\
      \ \\\n  -DCMAKE_C_FLAGS=\"%{optflags}\" \\\n  -DCMAKE_EXE_LINKER_FLAGS=\"-L$COMPAT_DIR -lmogrix-compat\" \\\n  -DCMAKE_SHARED_LINKER_FLAGS=\"-L$COMPAT_DIR -lmogrix-compat\" \\\n  -DCMAKE_C_COMPILER_WORKS=TRUE\
      \ \\\n  -DCMAKE_MAKE_PROGRAM=/usr/bin/make \\\n  -DBUILD_STATIC_LIBS=OFF \\\n  -DLIB_SUFFIX=32\nmake %{?_smp_mflags} -C .\n"
  - pattern: '# MinGW build

      %mingw_cmake

      %mingw_make_build'
    replacement: '# MinGW build disabled for IRIX cross-compilation'
  - pattern: '%cmake_install'
    replacement: make -C _build DESTDIR=$RPM_BUILD_ROOT install
  - pattern: '%mingw_make_install

      rm -rf %{buildroot}%{mingw32_mandir}

      rm -rf %{buildroot}%{mingw64_mandir}'
    replacement: '# MinGW install disabled'
  - pattern: '%mingw_debug_install_post'
    replacement: '# mingw debug disabled'
  - pattern: '%{?mingw_debug_package}'
    replacement: '# mingw_debug_package disabled'
  - pattern: '^Name:           giflib'
    replacement: 'Name:           giflib

      Provides: giflib(mips-32) = %{version}-%{release}

      Provides: libgif.so.7

      '
