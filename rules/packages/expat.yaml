# expat - XML parser library
# Foundation library for many packages
# Successfully cross-compiled for IRIX N32

package: expat

rules:
  # Compat functions needed (C99 functions missing from IRIX)
  inject_compat_functions:
    - strtof

  # Autoconf cache overrides
  ac_cv_overrides:
    ac_cv_func_malloc_0_nonnull: "yes"
    ac_cv_func_realloc_0_nonnull: "yes"

  # Configure flags
  configure_flags:
    add:
      - --disable-silent-rules
      - --without-docbook
      - --without-examples
      - --without-tests

  # Skip man pages (no docbook for cross-compilation)
  skip_manpages: true

  # Skip find_lang (no translations)
  skip_find_lang: true

  # Make options to skip doc directory (no xmlto for cross-compilation)
  make_env:
    SUBDIRS: "lib xmlwf"

  # Remove duplicate docs and .la files
  install_cleanup:
    - "rm -rf $RPM_BUILD_ROOT%{_datadir}/doc/expat"
    - "find $RPM_BUILD_ROOT -name '*.la' -delete"
