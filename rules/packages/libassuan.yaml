# libassuan - IPC library for GnuPG
# Requires patches for IRIX cross-compilation:
#
# IRIX has conflicting feature test macros:
#   - _XOPEN_SOURCE=500 gives SCM_RIGHTS and snprintf, but hides IPv6 and inet_pton
#   - _SGI_SOURCE gives IPv6, snprintf, inet_pton, but hides SCM_RIGHTS
#
# Solution: Use _SGI_SOURCE and manually define SCM_RIGHTS=0x01
#
# Source patches needed:
#   1. src/assuan-defs.h: Add missing declarations for unsetenv() and clearenv()
#   2. src/assuan-socket.c: Add includes for sys/time.h and sys/select.h
#   3. src/assuan-socket-connect.c: Add extern declaration for inet_pton (IRIX compat)

package: libassuan

rules:
  # IRIX needs _SGI_SOURCE for IPv6/snprintf, and manual SCM_RIGHTS definition
  extra_cflags:
    - -D_SGI_SOURCE
    - -DSCM_RIGHTS=0x01

  # Configure flags
  configure_flags:
    add:
      - --enable-shared
      - --disable-static
