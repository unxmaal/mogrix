# pixman - Pixel manipulation library (FC40: 0.43.0)
# Uses meson build system; no assembly optimizations for MIPS
package: pixman

rules:

  spec_replacements:
    # Replace %meson with raw meson commands using our cross file
    - pattern: "%meson --auto-features=auto \\\n%ifarch %{arm}\n  -Diwmmxt=disabled -Diwmmxt2=false \\\n%endif\n  %nil\n\n%meson_build"
      replacement: "MOGRIX_CROSS=/home/edodd/projects/github/unxmaal/mogrix/cross/meson-irix-cross.ini\n/home/edodd/.local/bin/meson setup _build \\\n  --cross-file=$MOGRIX_CROSS \\\n  --prefix=%{_prefix} \\\n  --libdir=%{_libdir} \\\n  --auto-features=auto \\\n  -Dtests=disabled \\\n  -Ddemos=disabled \\\n  -Dc_link_args=\"-L$COMPAT_DIR -lmogrix-compat\"\n/home/edodd/.local/bin/meson compile -C _build"

    # Replace %meson_install
    - pattern: "%meson_install"
      replacement: "DESTDIR=$RPM_BUILD_ROOT /home/edodd/.local/bin/meson install -C _build --no-rebuild"

