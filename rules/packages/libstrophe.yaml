package: libstrophe
rules:
  inject_compat_functions:
  - explicit_bzero
  configure_flags:
    add:
    - --disable-examples
    remove:
    - --enable-coverage
  drop_buildrequires:
  - lcov
  drop_subpackages:
  - doc
  spec_replacements:
  - pattern: autoreconf -i -W all
    replacement: 'autoreconf -i -W all

      sed -i ''s|RESOLV_LIBS="-lresolv"|RESOLV_LIBS=""|'' configure'
  - pattern: '# Build HTML documentation

      doxygen

      make coverage  # results are in coverage/'
    replacement: '# Docs/coverage disabled for cross-compilation'
  - pattern: '# Install HTML documentation for the doc subpackage

      mkdir -p %{buildroot}%{_pkgdocdir}/

      cp -a docs/html/ %{buildroot}%{_pkgdocdir}/

      cp -a coverage/ %{buildroot}%{_pkgdocdir}/html/'
    replacement: '# Doc/coverage install disabled for cross-compilation'
  - pattern: '# Install examples/ dir shipping binary files generated

      mkdir -p %{buildroot}%{_libdir}/%{name}/

      cp -a examples/ %{buildroot}%{_libdir}/%{name}/

      mv %{buildroot}%{_libdir}/%{name}/examples/.libs %{buildroot}%{_libdir}/%{name}/examples/libs

      mv %{buildroot}%{_libdir}/%{name}/examples/.deps %{buildroot}%{_libdir}/%{name}/examples/deps

      rm -f %{buildroot}%{_libdir}/%{name}/examples/.dirstamp

      rm -f %{buildroot}%{_libdir}/%{name}/examples/deps/.dirstamp'
    replacement: '# Examples install disabled for cross-compilation'
  - pattern: '%{_libdir}/%{name}/'
    replacement: ''
  - pattern: '^Name:           libstrophe'
    replacement: 'Name:           libstrophe

      Provides: libstrophe(mips-32) = %{version}-%{release}

      Provides: libstrophe.so.0

      '
