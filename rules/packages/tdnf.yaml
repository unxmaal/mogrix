# tdnf - Tiny DNF package manager
# TARGET PACKAGE - The goal of the entire mogrix project
# Has sgifixes patches, needs compat functions

package: tdnf


# IRIX-specific patches from SGUG-RSE
add_patch:
  - client-defines.sgifixes.patch
  - cmakelist-paths.sgifixes.patch
  - tdnf-client-rpmtrans.sgifixes.patch
  - tdnf-client.sgifixes.patch
  - tdnf-common-utils.sgifixes.patch
  - tdnf-conf.sgifixes.patch
  - tdnf-pool.sgifixes.patch
  - tdnf-printfprecision.sgifixes.patch

rules:
  # Compat functions needed
  inject_compat_functions:
    - strdup
    - strndup
    - getline
    - asprintf
    - vasprintf

  # Drop problematic dependencies (libdicl handled in generic.yaml)
  drop_buildrequires:
    - systemd-devel
    - gpgme-devel

  drop_requires:
    - systemd

  # tdnf uses cmake
  # CMake options for IRIX:
  # -DSYSTEMD_DIR=OFF or remove systemd integration
  # -DWITH_METALINK=ON

  # Comment out systemd conditionals
  comment_conditionals:
    - with_systemd
    - systemd
