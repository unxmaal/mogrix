package: libxcb
rules:
  prep_commands:
  - export PYTHONPATH=/opt/sgug-staging/usr/sgug/lib/python3.12/site-packages:$PYTHONPATH
  drop_buildrequires:
  - graphviz
  - libtool
  - pkgconfig(xorg-macros)
  configure_flags:
    add:
    - --disable-selinux
    - --disable-doxygen
    remove:
    - --enable-selinux
  export_vars:
    LDFLAGS: -lX11
  spec_replacements:
  - pattern: 'sed -i ''s/pthread-stubs //'' configure.ac

      # autoreconf -f needed to expunge rpaths

      autoreconf -v -f --install'
    replacement: 'export PYTHONPATH=/opt/sgug-staging/usr/sgug/lib/python3.12/site-packages:$PYTHONPATH

      # Skip autoreconf â€” use distributed configure, provide pthread-stubs.pc

      '
  - pattern: 'URL:        http://xcb.freedesktop.org/'
    replacement: 'URL:        http://xcb.freedesktop.org/

      Provides: libxcb.so.1(mips-32)

      Provides: libxcb-xkb.so.1(mips-32)

      Provides: libxcb-render.so.0(mips-32)

      Provides: libxcb-shm.so.0(mips-32)

      Provides: libxcb-shape.so.0(mips-32)

      Provides: libxcb-xinput.so.0(mips-32)

      Provides: libxcb-xfixes.so.0(mips-32)

      Provides: libxcb-sync.so.1(mips-32)

      Provides: libxcb-randr.so.0(mips-32)

      Provides: libxcb-glx.so.0(mips-32)

      Provides: libxcb-keysyms.so.0(mips-32)

      Provides: libxcb-icccm.so.0(mips-32)

      Provides: libxcb(mips-32) = %{version}-%{release}

      '
  - pattern: 'Requires:   %{name}%{?_isa} = %{version}-%{release}'
    replacement: 'Requires:   %{name} = %{version}-%{release}'
  - pattern: '%package doc

      Summary:    Documentation for %{name}

      BuildArch:  noarch


      %description doc

      The %{name}-doc package contains documentation for the %{name} library.'
    replacement: '# doc subpackage removed'
  - pattern: '%files doc

      %{_pkgdocdir}'
    replacement: '# doc files removed'
  - pattern: '%ldconfig_post


      %ldconfig_postun'
    replacement: '# ldconfig scriptlets removed'
  - pattern: '%{_libdir}/libxcb-xselinux.so.0*

      '
    replacement: ''
  install_cleanup:
  - rm -rf %{buildroot}%{_pkgdocdir}
