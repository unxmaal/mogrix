# python3 - Python interpreter
# Has sgifixes patches, needs compat functions

package: python3

# IRIX-specific patches from SGUG-RSE
add_patch:
  - python3.sgifixes.patch

rules:
  # Compat functions needed

  # NOTE: libdicl/systemtap-sdt-devel drop_buildrequires/drop_requires handled by generic.yaml
  drop_buildrequires:
    - valgrind-devel
    - libnsl2-devel
    - libtirpc-devel
    - bluez-libs-devel

  # Autoconf cache overrides
  # NOTE: ac_cv_func_malloc/realloc_0_nonnull handled by generic.yaml
  ac_cv_overrides:
    ac_cv_file__dev_ptmx: "no"
    ac_cv_file__dev_ptc: "no"
    ac_cv_func_getentropy: "no"
    ac_cv_func_getrandom: "no"

  # Configure flags
  configure_flags:
    add:
      - --without-dtrace
      - --without-valgrind
      - --disable-ipv6
      - --without-ensurepip
      - --with-system-expat
      - --with-system-ffi
    remove:
      - --enable-optimizations
      - --with-lto
      - --with-dtrace

  # NOTE: libdicl remove_lines handled by generic.yaml

  # Comment out systemd-related conditionals
  comment_conditionals:
    - with_systemd

