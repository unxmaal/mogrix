# gpgme - GnuPG Made Easy
# High-level crypto API for GnuPG
#
# Requires:
#   - libgpg-error
#   - libassuan
#   - irix-compat.h header with isinf() macro
#
# Notes:
#   - IRIX lacks isinf() in headers unless __c99 is defined, which causes conflicts
#   - Solution: Use -include irix-compat.h that provides isinf() macro

package: gpgme

rules:
  # Drop libdicl dependency
  drop_buildrequires:
    - libdicl-devel
    - libdicl

  drop_requires:
    - libdicl
    - libdicl-devel

  # IRIX needs _SGI_SOURCE and SCM_RIGHTS, plus isinf via compat header
  extra_cflags:
    - -D_SGI_SOURCE
    - -DSCM_RIGHTS=0x01
    - -include irix-compat.h

  # Configure flags
  configure_flags:
    add:
      - --enable-shared
      - --disable-static
      - --disable-gpg-test
      - --disable-gpgsm-test
      - --disable-gpgconf-test
      - --disable-g13-test

  # Autoconf cache overrides
  ac_cv_overrides:
    ac_cv_func_malloc_0_nonnull: "yes"
    ac_cv_func_realloc_0_nonnull: "yes"

  # Skip tests during cross-compilation
  skip_check: true
