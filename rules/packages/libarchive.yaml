# libarchive - Multi-format archive and compression library
# Has sgifixes patches

package: libarchive

rules:
  # Compat functions that may be needed
  inject_compat_functions:
    - strdup
    - strndup

  # Drop problematic dependencies
  drop_buildrequires:
    - libacl-devel
    - libattr-devel
    - e2fsprogs-devel

  # Autoconf cache overrides
  ac_cv_overrides:
    ac_cv_func_malloc_0_nonnull: "yes"
    ac_cv_func_realloc_0_nonnull: "yes"

  # Configure flags
  configure_flags:
    add:
      - --disable-silent-rules
      - --disable-acl
      - --disable-xattr
      - --without-nettle
      - --without-libb2
    remove:
      - --with-zstd

  configure_disable:
    - acl
    - xattr
