package: tar
classes:
- nls-disabled
smoke_test:
- command: /usr/sgug/bin/tar --version
  expect: '1.35'
rules:
  drop_buildrequires:
  - acl
  - attr
  - policycoreutils
  drop_requires:
  - info
  configure_flags:
    add:
    - --without-selinux
    - --without-posix-acls
    - --disable-year2038
  spec_replacements:
  - pattern: mv ChangeLog{,~}
    replacement: mv ChangeLog ChangeLog~
  - pattern: autoreconf -v
    replacement: AUTOPOINT=true autoreconf -v
  prep_commands:
  - "$MOGRIX_ROOT/tools/safepatch Makefile.in --old 'gnulib-tests' --new '' --no-backup --quiet || true"
  - "$MOGRIX_ROOT/tools/safepatch Makefile.am --old 'gnulib-tests' --new '' --no-backup --quiet || true"
  - "for f in lib/paxerror.c lib/rtapelib.c; do $MOGRIX_ROOT/tools/safepatch $f --old '%zu' --new '%u' --count 0 --no-backup --quiet || :; $MOGRIX_ROOT/tools/safepatch $f --old '%zd' --new '%d' --count 0 --no-backup --quiet || :; $MOGRIX_ROOT/tools/safepatch $f --old '%zx' --new '%x' --count 0 --no-backup --quiet || :; done"
  - "$MOGRIX_ROOT/tools/safepatch gnu/malloc/dynarray_at_failure.c --old '%zu' --new '%u' --count 0 --no-backup --quiet || true; $MOGRIX_ROOT/tools/safepatch gnu/malloc/dynarray_at_failure.c --old '%zd' --new '%d' --count 0 --no-backup --quiet || true; $MOGRIX_ROOT/tools/safepatch gnu/malloc/dynarray_at_failure.c --old '%zx' --new '%x' --count 0 --no-backup --quiet || true"
