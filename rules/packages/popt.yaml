package: popt
add_patch:
- popt-disable-stpcpy.patch
- popt-disable-mbsrtowcs.patch
rules:
  configure_flags:
    add:
    - --disable-nls
  export_vars:
    LD: /opt/cross/bin/mips-sgi-irix6.5-ld.bfd
  install_cleanup:
  - find $RPM_BUILD_ROOT -name '*.la' -delete
  files_no_lang: true
  ac_cv_overrides:
    ac_cv_func_strerror_r_char_p: 'no'
    ac_cv_func_mbsnrtowcs: 'no'
    ac_cv_func_mbsrtowcs: 'no'
    ac_cv_func_vasprintf: 'yes'
    ac_cv_func_stpcpy: 'yes'
  spec_replacements:
  - pattern: export LD="/opt/cross/bin/mips-sgi-irix6.5-ld.bfd"
    replacement: 'export LD="/opt/cross/bin/mips-sgi-irix6.5-ld.bfd"

      # Tell libtool to use our CC for linking (handles linker selection internally)

      export lt_cv_prog_compiler_static_works=no

      '
  - pattern: '%configure'
    replacement: '%configure

      # Fix libtool to build shared libraries for IRIX

      $MOGRIX_ROOT/tools/fix-libtool-irix.sh libtool || exit 1

      '
