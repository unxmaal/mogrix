package: grep
classes:
- nls-disabled
smoke_test:
- command: echo hello | /usr/sgug/bin/grep hello
  expect: hello
- command: /usr/sgug/bin/grep --version
  expect: '3.11'
rules:
  drop_buildrequires:
  - libsigsegv-devel
  configure_flags:
    add:
    - --disable-perl-regexp
    remove:
    - --without-included-regex
  prep_commands:
  - "$MOGRIX_ROOT/tools/safepatch lib/malloc/dynarray_at_failure.c --old '%zu' --new '%u' --count 0 --no-backup --quiet"
  - "$MOGRIX_ROOT/tools/safepatch Makefile.am --old ' gnulib-tests' --new '' --no-backup --quiet"
  - "$MOGRIX_ROOT/tools/safepatch Makefile.am --old ' tests' --new '' --no-backup --quiet"
  spec_replacements:
  - pattern: autoreconf -fi
    replacement: AUTOPOINT=true autoreconf -fi
