# xclip - X11 clipboard command-line tool (FC40: 0.13)
# Uses X11 from IRIX native sysroot (like aterm)
package: xclip

rules:

  prep_commands:
    # IRIX X11R6.3 Xmu/Atoms.h doesn't have XA_UTF8_STRING (X11R6.4+).
    # Define it as XInternAtom lookup — functionally identical.
    - "for f in xclip.c xclib.c borked.c; do $MOGRIX_ROOT/tools/safepatch $f --old '#include <X11/Xmu/Atoms.h>' --insert-after \"$(printf '#ifndef XA_UTF8_STRING\\n#define XA_UTF8_STRING(dpy) XInternAtom(dpy, \"UTF8_STRING\", False)\\n#endif')\" --no-backup --quiet; done"

  spec_replacements:
    # rpmbuild uses /bin/sh — ${c:0:7} is a bash substring expansion
    # Hardcode the shortcommit value from the spec's commit hash
    - pattern: "%global shortcommit %(c=%{commit}; echo ${c:0:7})"
      replacement: "%global shortcommit 11cba61"

